# 缓存机制

## HTTP缓存体系
![](./assets/image/browser/cache-1.png)

## 缓存存储策略
用于决定Http响应内容是否可缓存到客户端

### Cache-Control
* Public（Public设置我们可以将Http响应数据存储到本地，但此时并不意味着后续浏览器会直接从缓存中读取数据并使用。为啥？因为它无法确定本地缓存的数据是否可用，可能已经失效）
* Private
* no-cache（应理解为不建议使用本地缓存，其仍然会缓存数据到本地）
* max-age
* no-store（不会在客户端缓存任何响应数据）


## 缓存过期策略
决定客户端是否可直接从本地缓存数据中加载数据并展示（否则就发请求到服务端获取）

### Expires
指明了缓存数据有效的绝对时间。

### max-age
![](./assets/image/browser/cache-2.png)


⚠️需要注意的是：
1. Cache-Control中指定的缓存过期策略优先级高于Expires，当它们同时存在的时候，后者会被覆盖掉
2. 缓存数据标记为已过期只是客户端不能再直接从本地读取缓存了，需要再发一次请求到服务器去确认，并不等同于本地缓存数据从此就没用了，有些情况下即使过期了还是会被再次用到

## 缓存对比策略
将缓存在客户端的数据标识发往服务端，服务端通过标识来判断客户端缓存数据是否仍有效，进而决定是否要重发数据

## 三者关系
![](./assets/image/browser/cache-3.png)

通过上图，我们可以清晰的看到各缓存项分别属于哪个缓存策略范畴，这其中有部分重叠，它表明这些缓存项具有多重缓存策略，所以实际在分析缓存头的时候，除了常规的头外，我们还需要将这些具有双重缓存策略的项分解开来。